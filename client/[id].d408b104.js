import{S as t,i as e,s,e as n,b as a,f as r,d as c,h as o,j as i,k as l,n as d,l as h,o as u,m as f,u as g,p as m,r as p,v as I,w as v,x as $,y,z as w,t as E,g as b,A as V,a as T,B as D,c as k,C as x,D as M,E as N,F as _,G as B}from"./client.0a128855.js";function S(t){let e,s;return{c(){e=n("div"),s=n("div"),this.h()},l(t){e=a(t,"DIV",{class:!0});var n=r(e);s=a(n,"DIV",{id:!0}),r(s).forEach(c),n.forEach(c),this.h()},h(){o(s,"id",t[0]),o(e,"class","yt-component")},m(t,n){i(t,e,n),l(e,s)},p:d,i:d,o:d,d(t){t&&c(e)}}}let A=!1;function C(t,e,s){let n;const a=h();let r,c="player_"+parseInt(1e5*Math.random()).toString(),{videoId:o}=e,{height:i="390"}=e,{width:l="640"}=e,{goTo:d}=e;function f(t){a("StateChange",t)}return u(()=>{let t="https://www.youtube.com/iframe_api?origin=http://localhost:3000";if(!function(t=""){for(var e=document.getElementsByTagName("script"),s=e.length;s--;)if(e[s].src==t)return!0;return!1}(t)){var e=document.createElement("script");e.src=t;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(e,s)}function d(){n=new YT.Player(c,{height:i,width:l,videoId:o,playerVars:{autoplay:1,controls:0,disablekb:1,fs:0},events:{onStateChange:f}});let t=0;r=setInterval((function(){let e=t;n&&n.getCurrentTime&&(t=n.getCurrentTime()),t!==e&&a("timeupdate",t)}),800)}return window.onYouTubeIframeAPIReady=function(){window.dispatchEvent(new Event("YouTubeIframeAPIReady"))},window.addEventListener("YouTubeIframeAPIReady",(function(){0==A&&(A=!0,d())})),A&&d(),()=>r&&clearInterval(r)}),t.$$set=t=>{"videoId"in t&&s(1,o=t.videoId),"height"in t&&s(2,i=t.height),"width"in t&&s(3,l=t.width),"goTo"in t&&s(4,d=t.goTo)},t.$$.update=()=>{16&t.$$.dirty&&function(t){n&&t&&t>0&&n.seekTo(t,!0)}(d)},[c,o,i,l,d,function(){n.playVideo()}]}class j extends t{constructor(t){super(),e(this,t,C,S,s,{videoId:1,height:2,width:3,goTo:4,playVideo:5})}get playVideo(){return this.$$.ctx[5]}}function P(t,e,s){const n=t.slice();return n[4]=e[s],n}function R(t,e){let s,n;const a=e[3].default,r=y(a,e,e[2],null);return{key:t,first:null,c(){s=f(),r&&r.c(),this.h()},l(t){s=f(),r&&r.l(t),this.h()},h(){this.first=s},m(t,e){i(t,s,e),r&&r.m(t,e),n=!0},p(t,e){r&&r.p&&4&e&&g(r,a,t,t[2],e,null,null)},i(t){n||(m(r,t),n=!0)},o(t){p(r,t),n=!1},d(t){t&&c(s),r&&r.d(t)}}}function U(t){let e,s,n=[],a=new Map,r=t[1];const o=t=>t[0];for(let e=0;e<r.length;e+=1){let s=P(t,r,e),c=o(s);a.set(c,n[e]=R(c,s))}return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=f()},l(t){for(let e=0;e<n.length;e+=1)n[e].l(t);e=f()},m(t,a){for(let e=0;e<n.length;e+=1)n[e].m(t,a);i(t,e,a),s=!0},p(t,[s]){if(4&s){const r=t[1];I(),n=v(n,s,o,1,t,r,a,e.parentNode,w,R,e,P),$()}},i(t){if(!s){for(let t=0;t<r.length;t+=1)m(n[t]);s=!0}},o(t){for(let t=0;t<n.length;t+=1)p(n[t]);s=!1},d(t){for(let e=0;e<n.length;e+=1)n[e].d(t);t&&c(e)}}}function Y(t,e,s){let{key:n}=e;let{$$slots:a={},$$scope:r}=e;return t.$$set=t=>{"key"in t&&s(0,n=t.key),"$$scope"in t&&s(2,r=t.$$scope)},[n,[0],r,a]}class O extends t{constructor(t){super(),e(this,t,Y,U,s,{key:0})}}function L(t){for(let e=t.length-1;e>0;e--){let s=Math.floor(Math.random()*(e+1));[t[e],t[s]]=[t[s],t[e]]}return t}function q(t,e,s){const n=t.slice();return n[21]=e[s],n}function z(t){let e,s,h,u,f,g,m;return{c(){e=n("div"),s=n("div"),h=n("div"),u=n("button"),f=E("Начать!"),this.h()},l(t){e=a(t,"DIV",{class:!0});var n=r(e);s=a(n,"DIV",{class:!0});var o=r(s);h=a(o,"DIV",{class:!0});var i=r(h);u=a(i,"BUTTON",{class:!0});var l=r(u);f=b(l,"Начать!"),l.forEach(c),i.forEach(c),o.forEach(c),n.forEach(c),this.h()},h(){o(u,"class","btn btn-secondary btn-block btn-lg"),o(h,"class","col-md-6"),o(s,"class","row h-100 py-5 justify-content-center align-items-center"),o(e,"class","container py-5")},m(n,a){i(n,e,a),l(e,s),l(s,h),l(h,u),l(u,f),g||(m=V(u,"click",t[17]),g=!0)},p:d,i:d,o:d,d(t){t&&c(e),g=!1,m()}}}function F(t){let e,s,d,h,u,f,g,I,v;g=new O({props:{key:t[0].yt_id,$$slots:{default:[G]},$$scope:{ctx:t}}});let $=t[1].id&&H(t);return{c(){e=n("div"),s=n("div"),d=n("div"),h=n("div"),u=T(),f=n("div"),D(g.$$.fragment),I=T(),$&&$.c(),this.h()},l(t){e=a(t,"DIV",{class:!0});var n=r(e);s=a(n,"DIV",{class:!0});var o=r(s);d=a(o,"DIV",{class:!0});var i=r(d);h=a(i,"DIV",{class:!0});var l=r(h);u=k(l),f=a(l,"DIV",{class:!0});var m=r(f);x(g.$$.fragment,m),m.forEach(c),l.forEach(c),i.forEach(c),I=k(o),$&&$.l(o),o.forEach(c),n.forEach(c),this.h()},h(){o(f,"class","inner svelte-16iul4o"),o(h,"class","wrap svelte-16iul4o"),o(d,"class","col-12"),o(s,"class","row"),o(e,"class","container py-5")},m(t,n){i(t,e,n),l(e,s),l(s,d),l(d,h),l(h,u),l(h,f),M(g,f,null),l(s,I),$&&$.m(s,null),v=!0},p(t,e){const n={};1&e&&(n.key=t[0].yt_id),16777257&e&&(n.$$scope={dirty:e,ctx:t}),g.$set(n),t[1].id?$?$.p(t,e):($=H(t),$.c(),$.m(s,null)):$&&($.d(1),$=null)},i(t){v||(m(g.$$.fragment,t),v=!0)},o(t){p(g.$$.fragment,t),v=!1},d(t){t&&c(e),N(g),$&&$.d()}}}function G(t){let e,s;return e=new j({props:{key:t[0].yt_id,height:"100%",width:"100%",videoId:t[0].yt_id,goTo:t[5]}}),e.$on("timeupdate",t[14]),e.$on("StateChange",t[7]),{c(){D(e.$$.fragment)},l(t){x(e.$$.fragment,t)},m(t,n){M(e,t,n),s=!0},p(t,s){const n={};1&s&&(n.key=t[0].yt_id),1&s&&(n.videoId=t[0].yt_id),32&s&&(n.goTo=t[5]),e.$set(n)},i(t){s||(m(e.$$.fragment,t),s=!0)},o(t){p(e.$$.fragment,t),s=!1},d(t){N(e,t)}}}function H(t){let e;function s(t,e){return void 0===t[4]?K:J}let n=s(t),a=n(t);return{c(){a.c(),e=f()},l(t){a.l(t),e=f()},m(t,s){a.m(t,s),i(t,e,s)},p(t,r){n===(n=s(t))&&a?a.p(t,r):(a.d(1),a=n(t),a&&(a.c(),a.m(e.parentNode,e)))},d(t){a.d(t),t&&c(e)}}}function J(t){let e,s,d,h,u,f;function g(t,e){return t[4]===t[1].rightAnswer?W:Q}let m=g(t),p=m(t);return{c(){p.c(),e=T(),s=n("div"),d=n("button"),h=E("Перести к следующему вопросу"),this.h()},l(t){p.l(t),e=k(t),s=a(t,"DIV",{class:!0});var n=r(s);d=a(n,"BUTTON",{class:!0});var o=r(d);h=b(o,"Перести к следующему вопросу"),o.forEach(c),n.forEach(c),this.h()},h(){o(d,"class","btn btn-secondary btn-block btn-lg"),o(s,"class","col-md-12 mt-3")},m(n,a){p.m(n,a),i(n,e,a),i(n,s,a),l(s,d),l(d,h),u||(f=V(d,"click",t[16]),u=!0)},p(t,s){m!==(m=g(t))&&(p.d(1),p=m(t),p&&(p.c(),p.m(e.parentNode,e)))},d(t){p.d(t),t&&c(e),t&&c(s),u=!1,f()}}}function K(t){let e,s=t[1].answers,n=[];for(let e=0;e<s.length;e+=1)n[e]=X(q(t,s,e));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=f()},l(t){for(let e=0;e<n.length;e+=1)n[e].l(t);e=f()},m(t,s){for(let e=0;e<n.length;e+=1)n[e].m(t,s);i(t,e,s)},p(t,a){if(66&a){let r;for(s=t[1].answers,r=0;r<s.length;r+=1){const c=q(t,s,r);n[r]?n[r].p(c,a):(n[r]=X(c),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=s.length}},d(t){B(n,t),t&&c(e)}}}function Q(t){let e,s,d,h,u;return{c(){e=n("div"),s=n("div"),d=E("Неправильный ответ"),h=T(),u=n("div"),this.h()},l(t){e=a(t,"DIV",{class:!0});var n=r(e);s=a(n,"DIV",{class:!0});var o=r(s);d=b(o,"Неправильный ответ"),o.forEach(c),n.forEach(c),h=k(t),u=a(t,"DIV",{class:!0}),r(u).forEach(c),this.h()},h(){o(s,"class","alert alert-danger"),o(e,"class","col-md-6 mx-auto mt-3"),o(u,"class","w-100")},m(t,n){i(t,e,n),l(e,s),l(s,d),i(t,h,n),i(t,u,n)},d(t){t&&c(e),t&&c(h),t&&c(u)}}}function W(t){let e,s,d,h,u;return{c(){e=n("div"),s=n("div"),d=E("Правильный ответ"),h=T(),u=n("div"),this.h()},l(t){e=a(t,"DIV",{class:!0});var n=r(e);s=a(n,"DIV",{class:!0});var o=r(s);d=b(o,"Правильный ответ"),o.forEach(c),n.forEach(c),h=k(t),u=a(t,"DIV",{class:!0}),r(u).forEach(c),this.h()},h(){o(s,"class","alert alert-success"),o(e,"class","col-md-6 mx-auto mt-3"),o(u,"class","w-100")},m(t,n){i(t,e,n),l(e,s),l(s,d),i(t,h,n),i(t,u,n)},d(t){t&&c(e),t&&c(h),t&&c(u)}}}function X(t){let e,s,d,h,u,f,g=t[21]+"";function m(...e){return t[15](t[21],...e)}return{c(){e=n("div"),s=n("button"),d=E(g),h=T(),this.h()},l(t){e=a(t,"DIV",{class:!0});var n=r(e);s=a(n,"BUTTON",{class:!0});var o=r(s);d=b(o,g),o.forEach(c),h=k(n),n.forEach(c),this.h()},h(){o(s,"class","btn btn-secondary btn-block btn-lg"),o(e,"class","col-md-6 mt-3")},m(t,n){i(t,e,n),l(e,s),l(s,d),l(e,h),u||(f=V(s,"click",m),u=!0)},p(e,s){t=e,2&s&&g!==(g=t[21]+"")&&_(d,g)},d(t){t&&c(e),u=!1,f()}}}function Z(t){let e,s,n,a;const r=[F,z],o=[];function l(t,e){return t[2]?0:1}return e=l(t),s=o[e]=r[e](t),{c(){s.c(),n=f()},l(t){s.l(t),n=f()},m(t,s){o[e].m(t,s),i(t,n,s),a=!0},p(t,[a]){let c=e;e=l(t),e===c?o[e].p(t,a):(I(),p(o[c],1,1,()=>{o[c]=null}),$(),s=o[e],s||(s=o[e]=r[e](t),s.c()),m(s,1),s.m(n.parentNode,n))},i(t){a||(m(s),a=!0)},o(t){p(s),a=!1},d(t){o[e].d(t),t&&c(n)}}}async function tt(t,e){const{id:s}=t.params,{userId:n,score:a,inlineMessageId:r,chatId:c,messageId:o}=t.query,i=await this.fetch(`game/${s}.json`);return{game:await i.json(),id:s,userId:n,score:a,inlineMessageId:r,chatId:c,messageId:o}}function et(t,e,s){let n,a,{game:r}=e,{id:c}=e,{userId:o}=e,{inlineMessageId:i}=e,{chatId:l}=e,{messageId:d}=e,h={},u=!1,f=0,g=0;function m(t){s(4,n=t),t===h.rightAnswer&&(g+=1)}function p(){const t=r.songs.findIndex(t=>f>=t.guess[0]&&f<=t.answer[1]);t>-1&&t<r.songs.length&&s(5,a=r.songs[t+1].guess[0])}return t.$$set=t=>{"game"in t&&s(0,r=t.game),"id"in t&&s(9,c=t.id),"userId"in t&&s(10,o=t.userId),"inlineMessageId"in t&&s(11,i=t.inlineMessageId),"chatId"in t&&s(12,l=t.chatId),"messageId"in t&&s(13,d=t.messageId)},t.$$.update=()=>{8&t.$$.dirty&&function(t){let e=r.songs.find(e=>t>=e.guess[0]&&t<=e.answer[1]);e&&(e.id!==h.id&&(s(1,h={...e,answers:L(e.answers)}),s(4,n=void 0)),h.id&&t>=h.answer[0]&&t<=h.answer[1]&&(n||s(4,n=!1)))}(f)},[r,h,u,f,n,a,m,function({detail:t}){t.data,0===t.data&&fetch("/highScore/set?"+new URLSearchParams({userId:o,score:g,inlineMessageId:i,chatId:l,messageId:d})).catch(t=>console.log(t))},p,c,o,i,l,d,({detail:t})=>s(3,f=t),t=>m(t),()=>p(),()=>s(2,u=!0)]}export default class extends t{constructor(t){super(),e(this,t,et,Z,s,{game:0,id:9,userId:10,inlineMessageId:11,chatId:12,messageId:13})}}export{tt as preload};
